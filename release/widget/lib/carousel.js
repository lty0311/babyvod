function getTranslateX(e){return $support.transform3d?"translate3d("+e+"px, 0, 0)":"translate("+e+"px, 0)"}function getTranslateY(e){return $support.transform3d?"translate3d(0,"+e+"px, 0)":"translate(0,"+e+"px)"}function getPage(e,t){return $support.touch?e.changedTouches[0][t]:e[t]}var $support={transform3d:"WebKitCSSMatrix"in window,touch:"ontouchstart"in window},$E={start:$support.touch?"touchstart":"mousedown",move:$support.touch?"touchmove":"mousemove",end:$support.touch?"touchend":"mouseup",cancel:$support.touch?"touchcancel":"",transEndFn:"webkitTransitionEnd"},Slider=function(e,t){var n=this;return t=t||{},n.dir=t.dir.toLowerCase()||"x",n.touchEndFn=t.touchEndFn||null,n.transEndFn=t.transEndFn||null,n.touchStartFn=t.touchStartFn||null,n.infinite=t.infinite||!1,n.duration=parseFloat(t.duration)||300,n.nodes=[],e.nodeType&&1==e.nodeType?n.element=e:"string"==typeof e&&(n.element=document.querySelector(e)),n.Android4=window.navigator.userAgent.indexOf("Android 4.")>=0,"x"==n.dir?n.element.style.webkitTransform=getTranslateX(0):n.element.style.webkitTransform=getTranslateY(0),n.conf={},n.touchEnabled=!0,n.currentPoint=0,n.currentDis=0,n.element.parentNode.addEventListener($E.start,n,!1),n.element.parentNode.addEventListener($E.move,n,!1),n.element.addEventListener($E.transEndFn,n,!1),""!=$E.cancel&&(n.element.addEventListener($E.cancel,n,!1),document.addEventListener($E.cancel,n,!1)),document.addEventListener($E.end,n,!1),n.refresh(),n};Slider.prototype={handleEvent:function(e){var t=this;switch(e.type){case $E.start:t._touchStart(e);break;case $E.move:t._touchMove(e);break;case $E.end:case $E.cancel:t._touchEnd(e);break;case"click":t._click(e);break;case $E.transEndFn:t.transEndFn&&t.transEndFn(e)}},refresh:function(){var e=this,t=e.conf;e.maxPoint=t.point||function(){var t,n=e.element.childNodes,r=0,o=n.length;for(i=0;i<o;i++)t=n[i],1===t.nodeType&&(e.nodes[r]=t,r++);return r>0&&r--,r}(),"x"==e.dir?e.distance=parseInt(t.distance||window.getComputedStyle(e.element,null).width):e.distance=parseInt(t.distance||window.getComputedStyle(e.element,null).height),e.maxDis=t.maxDis?-t.maxDis:-e.distance*e.maxPoint,e.moveToPoint(e.currentPoint)},addSection:function(e){var t=this;t.element.appendChild(e),t.refresh()},getSection:function(e){var t=this,n=t.nodes[e];return n.childNodes[1]&&n.childNodes[1].childNodes[1]?n.childNodes[1].childNodes[1].childNodes[1]:n},hasNext:function(){var e=this;return e.currentPoint<e.maxPoint},hasPrev:function(){var e=this;return e.currentPoint>0},toNext:function(){var e=this;e.hasNext()&&e.moveToPoint(e.currentPoint+1)},toPrev:function(){var e=this;e.hasPrev()&&e.moveToPoint(e.currentPoint-1)},moveToPoint:function(e){var t=this;t.currentPoint=0>e?0:e>t.maxPoint?t.maxPoint:parseInt(e),t.element.style.webkitTransitionDuration=t.duration+"ms",t._setDis(-t.currentPoint*t.distance);var n=document.createEvent("Event");n.initEvent("css3flip.moveend",!0,!1),t.element.dispatchEvent(n)},_setDis:function(e){var t=this;t.currentDis=e,"x"==t.dir?t.element.style.webkitTransform=getTranslateX(e):t.element.style.webkitTransform=getTranslateY(e)},_touchStart:function(e){var t=this;t.touchStartFn&&t.touchStartFn(),t.touchEnabled&&($support.touch||e.preventDefault(),t.element.style.webkitTransitionDuration="0",t.scrolling=!0,t.moveReady=!1,t.startPageX=getPage(e,"pageX"),t.startPageY=getPage(e,"pageY"),"x"==t.dir?t.basePage=t.startPageX:t.basePage=t.startPageY,t.direction=0,t.startTime=e.timeStamp)},_touchMove:function(e){var t=this;if(t.scrolling){var n,r,o,a,i=getPage(e,"pageX"),s=getPage(e,"pageY");t.moveReady||(o=Math.abs(i-t.startPageX),a=Math.abs(s-t.startPageY),"x"==t.dir?o>a&&o>5?(t.Android4&&e.preventDefault(),t.moveReady=!0,t.element.parentNode.addEventListener("click",t,!0)):a>5&&(t.scrolling=!1,t.touchEndFn&&t.touchEndFn()):a>o&&a>5?(t.Android4&&e.preventDefault(),t.moveReady=!0,t.element.parentNode.addEventListener("click",t,!0)):o>5&&(t.scrolling=!1,t.touchEndFn&&t.touchEndFn())),t.moveReady&&("x"==t.dir?(n=i-t.basePage,isScroll=1):n=s-t.basePage,r=t.currentDis+n,(r>=0||r<t.maxDis)&&(r=Math.round(t.currentDis+n/3)),t._setDis(r),t.direction=n>0?-1:1),"x"==t.dir?t.basePage=i:t.basePage=s}},_touchEnd:function(e){isScroll=0;var t=this;if(t.scrolling){t.scrolling=!1;var n=-t.currentDis/t.distance;n=t.direction>0?Math.ceil(n):t.direction<0?Math.floor(n):Math.round(n),t.moveToPoint(n),setTimeout(function(){t.element.parentNode.removeEventListener("click",t,!0)},200),t.touchEndFn&&t.touchEndFn()}},_click:function(e){e.stopPropagation(),e.preventDefault()},destroy:function(){var e=this;e.element.parentNode.removeEventListener($E.start,e),e.element.parentNode.removeEventListener($E.move,e),e.element.parentNode.removeEventListener($E.transEndFn,e),e.element.parentNode.removeEventListener($E.cancel,e),document.removeEventListener($E.end,e),document.removeEventListener($E.cancel,e)}};